package utils

import (
	"fmt"
)

var ExchangeRates map[string]float64

func init() {
	// 定义汇率map
	ExchangeRates = map[string]float64{
		"ADA":  1.8696566964418844,
		"AED":  3.6725,
		"AFN":  70,
		"ALL":  85.295,
		"AMD":  383.82,
		"ANG":  1.8022999999999998,
		"AOA":  918.65,
		"ARS":  1371.4821,
		"AUD":  1.5559,
		"AWG":  1.79,
		"AZN":  1.7,
		"BAM":  1.7024609533,
		"BBD":  2.0181999999999998,
		"BCH":  0.0020517933915289712,
		"BDT":  122.24999999999999,
		"BGN":  1.712,
		"BHD":  0.377,
		"BIF":  2981,
		"BMD":  1,
		"BNB":  0.0010576276283038512,
		"BND":  1.2974999999999999,
		"BOB":  6.907100000000001,
		"BRL":  5.6015,
		"BSD":  0.9997,
		"BTC":  0.00000979843993895013,
		"BTN":  88.69474927520001,
		"BUSD": 0.9996936638705801,
		"BWP":  13.6553,
		"BYN":  3.2712,
		"BZD":  2.0078,
		"CAD":  1.3858,
		"CDF":  2178.0400374193,
		"CHF":  0.8140000000000001,
		"CLF":  0.0240945895,
		"CLP":  972.65,
		"COP":  4186.71,
		"CRC":  505.29,
		"CSC":  27887.582824566914,
		"CUP":  23.990199999999998,
		"CVE":  95.9850136878,
		"CZK":  21.5136,
		"DASH": 0.00921281474066514,
		"DJF":  178.08,
		"DKK":  6.5351,
		"DLS":  33.333333333333336,
		"DOGE": 6.103970889430352,
		"DOP":  61,
		"DZD":  130.923,
		"EGP":  48.57,
		"EOS":  1.2787330681036353,
		"ETB":  138.20000000000002,
		"ETC":  0.06945810145070301,
		"ETH":  0.0003011329868439056,
		"EUR":  0.8755000000000001,
		"FJD":  2.2723999999999998,
		"FKP":  0.7671653194,
		"GBP":  0.7571,
		"GC":   1,
		"GEL":  2.7035,
		"GHS":  10.5,
		"GIP":  0.7671653194,
		"GMD":  72.815,
		"GMS":  1,
		"GNF":  8674.5,
		"GTQ":  7.675,
		"GYD":  209.1771707264,
		"HKD":  7.849799999999999,
		"HNL":  26.2787,
		"HRK":  6.558439155099999,
		"HTG":  131.16899999999998,
		"HUF":  350.19,
		"IDR":  16443.4,
		"ILS":  3.3960999999999997,
		"INR":  87.503,
		"IQD":  1310,
		"IRR":  42112.5,
		"ISK":  124.46999999999998,
		"JMD":  159.94400000000002,
		"JOD":  0.709,
		"JPY":  150.81,
		"KES":  129.2,
		"KGS":  87.45,
		"KHR":  4015,
		"KMF":  431.5,
		"KPW":  900.0062936951,
		"KRW":  1392.51,
		"KWD":  0.30610000000000004,
		"KYD":  0.8313376419999999,
		"KZT":  540.8199999999999,
		"LAK":  21580,
		"LBP":  89550,
		"LKR":  302.25,
		"LRD":  183.40693895450002,
		"LSL":  18.2179,
		"LTC":  0.011549594406621793,
		"LYD":  5.415,
		"MAD":  9.154300000000001,
		"MDL":  17.08,
		"MGA":  4430,
		"MKD":  52.885000000000005,
		"MMK":  3247.961,
		"MNT":  3590,
		"MOP":  8.089,
		"MRU":  39.7653758622,
		"MUR":  46.65,
		"MVR":  15.459999999999999,
		"MWK":  1733.67,
		"MXN":  18.869,
		"MYR":  4.265,
		"MZN":  63.910000000000004,
		"NAD":  18.2179,
		"NGN":  1532.39,
		"NIO":  36.75,
		"NOK":  10.3276,
		"NPR":  140.07,
		"NZD":  1.6986,
		"OMR":  0.385,
		"PAB":  1.0009,
		"PEN":  3.569,
		"PGK":  4.1303,
		"PHP":  58.27,
		"PKR":  283.25,
		"PLN":  3.7442,
		"PYG":  7486.400000000001,
		"QAR":  3.6408,
		"R$":   476.1904761904762,
		"RON":  4.440300000000001,
		"RSD":  102.56500000000001,
		"RUB":  79.87530000000001,
		"RWF":  1440,
		"SAR":  3.7513,
		"SBD":  8.499720720500001,
		"SC":   1,
		"SCR":  14.1448,
		"SDG":  600.5,
		"SEK":  9.7896,
		"SGD":  1.2979,
		"SHIB": 112107.62331838565,
		"SHP":  0.7671653194,
		"SLE":  22.675111392199998,
		"SOL":  0.00635310423116285,
		"SOS":  571.5,
		"SRD":  39.0833540164,
		"SSP":  130.26,
		"SVC":  8.7464,
		"SYP":  13005,
		"SZL":  18.01,
		"THB":  32.752,
		"TND":  2.88,
		"TON":  0.5220447714229205,
		"TRX":  3.4841030134982516,
		"TRY":  40.6684,
		"TWD":  29.918000000000003,
		"TZS":  2570,
		"UAH":  41.6966,
		"uBTC": 9.798439938950128,
		"UGX":  3583.3,
		"USD":  1,
		"USDC": 1.0000633940185468,
		"USDT": 1,
		"UYU":  40.0886,
		"UZS":  12605,
		"VEF":  22472039.065282695,
		"VES":  123.7216,
		"VND":  26199,
		"XAF":  573.151,
		"XLM":  3.651044952797283,
		"XMR":  0.008457936691358008,
		"XOF":  566.5,
		"XRP":  0.4469066837705601,
		"ZAR":  18.2178,
		"ZEC":  0.0022003481538184285,
		"ZMW":  22.5280435465,
		"ZWL":  26.852999999999998,
	}
}

// 汇率转换函数
func ConvertCurrency(amount float64, fromCurrency, toCurrency string, rates map[string]float64) (float64, error) {
	if _, exists := rates[fromCurrency]; !exists {
		return 0, fmt.Errorf("货币代码不存在: %s", fromCurrency)
	}
	if _, exists := rates[toCurrency]; !exists {
		return 0, fmt.Errorf("货币代码不存在: %s", toCurrency)
	}

	if amount < 0 {
		return 0, fmt.Errorf("金额不能为负数: %.2f", amount)
	}

	if fromCurrency == toCurrency {
		return amount, nil
	}

	var result float64
	if fromCurrency == "USD" {
		result = amount * rates[toCurrency]
	} else if toCurrency == "USD" {
		result = amount / rates[fromCurrency]
	} else {
		usdAmount := amount / rates[fromCurrency]
		result = usdAmount * rates[toCurrency]
	}

	return result, nil
}
